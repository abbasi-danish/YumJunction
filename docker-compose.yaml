version: "3.8"
services:
  recipe-page:
    build: ./recipe-page
    container_name: recipe-page-group-M
    ports:
      - "3000:3000"
    volumes:
      - ./recipe-page:/usr/src/app
      - /usr/src/app/node_modules
    environment:
      - stdin_open=true
      - NODE_ENV=development
      - CHOKIDAR_USEPOLLING=true
    stdin_open: true
    tty: true

permissions:
  id-token: write
  contents: read
  jobs: 
    deploy-infra:
      name: Deploy Infra
      runs-on: windows-latest
      environment: 
      - name: Log into Azure
        uses: azure/login@v1
        with:
          client-id: ${{ secrets.AZURE_CLIENT_ID }}
          tenant-id: ${{ secrets.AZURE_TENANT_ID }}
          subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}